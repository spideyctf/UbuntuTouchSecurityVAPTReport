# CVE-2021-3493 - Linux Kernel OverlayFS Privilege Escalation

## Finding Information
- **Severity**: CRITICAL
- **CVE**: CVE-2021-3493
- **Component**: Linux Kernel OverlayFS
- **Discovery Date**: 2021-04-15

## Description
A privilege escalation vulnerability exists in the Linux kernel's OverlayFS implementation. This vulnerability allows a local attacker to gain root privileges by exploiting insufficient permission checks in the overlay filesystem.

## Technical Details
The vulnerability exists in the `ovl_copy_up_one()` function in `fs/overlayfs/copy_up.c`. The issue occurs when copying up files from lower layers to upper layers, where the kernel fails to properly validate file capabilities and security contexts.

**Root Cause**: The kernel does not properly strip capabilities from files during the copy-up process, allowing unprivileged users to create files with elevated capabilities.

**Affected Systems**: Ubuntu Touch devices running Linux kernel versions 3.13 through 5.11.

## Proof of Concept
```bash
# Create a file with capabilities in a lower overlay layer
echo '#!/bin/bash' > /tmp/exploit.sh
echo 'id' >> /tmp/exploit.sh
chmod +x /tmp/exploit.sh

# Use overlayfs to copy the file and exploit the vulnerability
# (See CVE-2021-3493-poc.c for detailed exploit code)
```

## Impact Assessment
- **Confidentiality**: High - Complete system access
- **Integrity**: High - Ability to modify system files
- **Availability**: High - Can crash or modify system services
- **Business Impact**: Complete compromise of device security, potential data theft, and system manipulation

## Remediation
### Immediate Actions
- [ ] Apply kernel security updates immediately
- [ ] Monitor for suspicious privilege escalation attempts
- [ ] Consider disabling overlayfs if not required

### Long-term Fixes
- [ ] Update to kernel version 5.12 or later
- [ ] Implement additional capability validation
- [ ] Regular security updates and monitoring

## References
- [CVE-2021-3493](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3493)
- [Ubuntu Security Notice](https://ubuntu.com/security/notices/USN-4915-1)

## Evidence
- Kernel version verification showing vulnerable version
- Successful privilege escalation demonstration
- System logs showing exploit execution

## Status
- [x] New
- [ ] In Progress
- [ ] Fixed
- [ ] Verified
